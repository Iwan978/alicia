import tinyColor from "tinycolor2";
import { throwError, isNodePattern } from "@jimp/utils";

function applyKernel(image, kernel, x, y) {
  const size = Math.floor((kernel.length - 1) / 2);
  const value = [0, 0, 0];

  for (let kx = 0; kx < kernel.length; kx += 1) {
    for (let ky = 0; ky < kernel[kx].length; ky += 1) {
      const idx = image.getPixelIndex(x + kx - size, y + ky - size);

      if (idx === -1) {
        continue;
      }

      value[0] += image.bitmap.data[idx] * kernel[kx][ky];
      value[1] += image.bitmap.data[idx + 1] * kernel[kx][ky];
      value[2] += image.bitmap.data[idx + 2] * kernel[kx][ky];
    }
  }

  return value;
}

const isDefined = (v) => typeof v !== "undefined" && v !== null;

function greyscale(image) {
  image.scanQuiet(
    0,
    
