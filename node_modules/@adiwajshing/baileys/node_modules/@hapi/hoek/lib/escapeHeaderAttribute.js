'use strict';

const Assert = require('./assert');

// Allowed value characters: !#$%&'()*+,-./:;<=>?@[]^_`{|}~ and space, a-z, A-Z, 0-9, \, "
const ALLOWED_CHARS_REGEX = /^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~\"\\]*$/u;

module.exports = function (attribute) {
  Assert(ALLOWED_CHARS_REGEX.test(attribute), 'Bad attribute value (' + attribute + ')');
  return escapeString(attribute);
};

function escapeString(str) {
  return str.replace(/\\/g, '\\\\').replace(/\"/g, '\\"');
}

